# SPPnet

<img src="https://user-images.githubusercontent.com/33839093/109107883-e1511b00-7775-11eb-8f79-504057772603.png">

	- ìœ„ : ê¸°ì¡´ CNNëª¨ë¸ì˜ ì•Œê³ ë¦¬ì¦˜
	- ì•„ë˜ : ì œì•ˆí•˜ëŠ” SPPnetì˜ ì•Œê³ ë¦¬ì¦˜

> - CNNì— í†µê³¼ì‹œí‚¬ ë•Œ ì…ë ¥ ì´ë¯¸ì§€ë¥¼ ìë¥´ê±°ë‚˜ ë¹„ìœ¨ì„ ì¡°ì •í•˜ë©´ ë³¸ë˜ì˜ ìƒê¹€ìƒˆì™€ ë‹¬ë¼ì§
> - ì…ë ¥ ì´ë¯¸ì§€ í¬ê¸°ì— ê´€ê³„ì—†ì´ conv layerë¥¼ í†µê³¼ì‹œí‚¤ê³ , fc layerì´ì „ì— feature mapì„ ë™ì¼í•œ í¬ê¸°ë¡œ ì¡°ì ˆí•´ì£¼ëŠ” poolingì„ ì ìš©í•˜ì!
> - ì‚¬ì‹¤ convolutionì—°ì‚°ì„ í•  ë•ŒëŠ” ì…ë ¥ ì´ë¯¸ì§€ì˜ í¬ê¸°ê°€ ì¼ì •í•  í•„ìš”X, convolution layerë‹¤ìŒì— ì´ì–´ì§€ëŠ” fully connected layerê°€ ê³ ì •ëœ í¬ê¸°ì˜ ì…ë ¥ì„ ë°›ìŒ
> - í•µì‹¬ : Spatial Pyramid Poolingì„ í†µí•´ í¬ê¸°ê°€ ë‹¤ë¥¸ CNN faeture mapìœ¼ë¡œë¶€í„° ê³ ì •ëœ í¬ê¸°ì˜ feature vectorë¥¼ ì¶”ì¶œí•¨

### ì „ì²´ ì•Œê³ ë¦¬ì¦˜
![spp_2](https://user-images.githubusercontent.com/33839093/109108890-b49e0300-7777-11eb-9529-2fb127c1468a.jpg)

> 1. ì´ë¯¸ì§€ë¥¼ pre-trained CNNì— í†µê³¼ì‹œì¼œ feature mapì„ ì¶”ì¶œ
> 2. selectie searchë¥¼ í†µí•´ ì–»ì€ roië“¤ì€ ê°ê° í¬ê¸°ì™€ ë¹„ìœ¨ì´ ë‹¤ë¦„-> SPPë¥¼ ì ìš©í•´ ê³ ì •ëœ í¬ê¸°ì˜ feature vectorë¥¼ ì¶”ì¶œ
> 3. fc layer í†µê³¼
> 4. ì¶”ì¶œí•œ ë²¡í„°ë¡œ ê° ì´ë¯¸ì§€ í´ë˜ìŠ¤ë³„ë¡œ SVm classifierë¥¼ í•™ìŠµì‹œí‚´
> 5. ì¶”ì¶œí•œ ë²¡í„°ë¡œ bounding box regressorë¥¼ í•™ìŠµì‹œí‚´

### Spatial Pyramid Pooling Structure
<img src="https://user-images.githubusercontent.com/33839093/109108955-d8614900-7777-11eb-8fbb-95fc8ba574b2.png">

> 1. ë¨¼ì € conv layerë¥¼ ê±°ì¹œ feature mapì„ inputìœ¼ë¡œ ë°›ì•„, ë¯¸ë¦¬ ì •í•´ì ¸ ìˆëŠ” ì˜ì—­ìœ¼ë¡œ ë‚˜ëˆ”
> - ìœ„ì˜ ì˜ˆì‹œëŠ” ë¯¸ë¦¬ 4x4, 2x2, 1x1 3ê°€ì§€ ì˜ì—­(í”¼ë¼ë¯¸ë“œ)ë¥¼ ì œê³µí•˜ë©°, 64x64x256í¬ê¸°ì˜ feature mapì´ ë“¤ì–´ì™”ì„ ë•Œ, 4x4í”¼ë¼ë¯¸ë“œì˜ í•œ ì¹¸ (bin)ì˜ í¬ê¸°ëŠ” 16x16
> 2. ê° binì—ì„œ ê°€ì¥ í° ê°’ë§Œ ì¶”ì¶œí•˜ëŠ” max poolingì„ ìˆ˜í–‰í•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ ì­‰ ì´ì–´ë¶™ì„
> - ì…ë ¥ ì´ë¯¸ì§€ì˜ ì±„ë„í¬ê¸°=k, binì˜ ê°œìˆ˜=Mì´ë©´, SPPì˜ ìµœì¢… output=(k*M)ì°¨ì› ë²¡í„°
> - ìœ„ì˜ ì˜ˆì‹œì—ì„œ k=256, M=(16+4+1)=21
> ğŸ‘‰ ì…ë ¥ ì´ë¯¸ì§€ì˜ í¬ê¸°ì™€ëŠ” ìƒê´€ã…‡ë²—ì´ ë¯¸ë¦¬ ì„¤ì •í•œ binì˜ ê°œìˆ˜ì™€ CNN ì±„ë„ê°’ìœ¼ë¡œ SPPì˜ ì¶œë ¥ì´ ê²°ì •ë¨, í•­ìƒ ë™ì¼í•œ í¬ê¸°ì˜ ê²°ê³¼ë¥¼ ë¦¬í„´í•¨

> - 3-level spp(4x4, 2x2, 1x1)ì„ ì‚¬ìš©í•˜ë©´, ì´ 2ê°œì˜ íŠ¹ì§•ì„ ì¶”ì¶œí•¨
> - 4-level spp(1x1, 2x2, 3x3, 6x6)ì„ ì‚¬ìš©í•˜ë©´, ì´ 50ê°œì˜ íŠ¹ì§•ì„ ì¶”ì¶œí•¨
> - convì¸µ feature map ì´ë¯¸ì§€ ê°œìˆ˜ê°€ 256ê°œë¼ë©´, 50x256=12,800ê°œì˜ íŠ¹ì§•ì„ ì¶”ì¶œí•¨

### R-CNNê³¼ SPPnet ë¹„êµ
![spp_vs](https://user-images.githubusercontent.com/33839093/109244392-f97e7400-7821-11eb-8d44-8a86e9e35914.png)

> - R-CNN : selective searchë¡œ 2ì²œê°œì˜ ì˜ì–µ ì°¾ê¸° > í¬ê¸°ê°€ ë‹¤ë¥¸ 2ì²œê°œì˜ ì˜ì—­ í¬ê¸°ì¡°ì ˆ > CNN ëª¨ë¸ í†µê³¼ > FC layer, SVM classifier í†µê³¼
> - SPPnet : selective searchë¡œ 2ì²œê°œì˜ ì˜ì—­ ì°¾ê¸° > CNN ëª¨ë¸ í†µê³¼ > SPPnetìœ¼ë¡œ ê³ ì •ëœ í¬ê¸°ì˜ feature vectorì–»ê¸° > FC layer, SVM classifier í†µê³¼

### í•œê³„ì 
> - ëª¨ë¸ì„ í•™ìŠµí•˜ëŠ”ë° ì—¬ëŸ¬ ë‹¨ê³„ê°€ í•„ìš”í•¨ : fine-tuning, SVM training, bounding box regression
> - ìµœì¢… classificationì¸ binary SVM, region proposalì—ëŠ” selective search ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•¨
> - fine-tuningì‹œì— SPPë¥¼ ê±°ì¹˜ì§€ ì´ì „ì˜ convolution ë ˆì´ì–´ë“¤ì€ í•™ìŠµì‹œí‚¤ì§€ ëª»í•¨ > Fast R-CNNì—ì„œ ìì„¸
